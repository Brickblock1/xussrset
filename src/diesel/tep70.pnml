 // tep70
// 173 (ADh)

#define IMAGEFILE  "src/diesel/tep70.png"
purchase_sprites(tep70_v1,   0, 0)
purchase_sprites(tep70_v2, 100, 0)
purchase_sprites_select(tep70, 1978)
diesel1r_sprites(12, tep70_v1,  32,   40)
diesel1r_sprites(13, tep70_v2,  32,  241)
diesel1r_sprites(13, tep70_v3,  32,  442)
diesel1r_sprites(13, tep70_v4,  32,  643)
diesel1r_sprites(13, tep70_v5,  32,  844)
diesel1r_sprites(13, tep70_v6,  32, 1045)
diesel1r_sprites(13, tep70_v7,  32, 1246)
diesel1r_sprites(13, tep70_v8,  32, 1447)
diesel1r_sprites(13, tep70_v9,  32, 1648)
diesel1r_sprites(13, tep70_v10, 32, 1849)
#undef IMAGEFILE

switch (FEAT_TRAINS, SELF, tep70_sprites_left_a1978,
  cargo_subtype)
{
  0:                      tep70_v2_sprites_left;
  LV_OCTOBER_RAILWAY:     tep70_v2_sprites_left;
  LV_MOSCOW_RAILWAY:      tep70_v3_sprites_left;
  LV_BELARUSSIAN_RAILWAY: tep70_v4_sprites_left;
  LV_NORTHERN_RAILWAY:    tep70_v5_sprites_left;
  align_13_sprites;
}

switch (FEAT_TRAINS, SELF, tep70_sprites_left_a1989,
  cargo_subtype)
{
  0:                      tep70_v6_sprites_left;
  LV_OCTOBER_RAILWAY:     tep70_v6_sprites_left;
  LV_MOSCOW_RAILWAY:      tep70_v7_sprites_left;
  LV_BELARUSSIAN_RAILWAY: tep70_v8_sprites_left;
  LV_NORTHERN_RAILWAY:    tep70_v9_sprites_left;
  LV_RZD_PID:             tep70_v10_sprites_left;
  align_13_sprites;
}

switch (FEAT_TRAINS, SELF, tep70_sprites_left,
  (build_year >= 1978) +
  (build_year >= 1989))
{
  0: tep70_v1_sprites_left;
  1: tep70_sprites_left_a1978;
     tep70_sprites_left_a1989;
}

switch (FEAT_TRAINS, SELF, tep70_sprites_right_a1978,
  cargo_subtype)
{
  0:                      tep70_v2_sprites_right;
  LV_OCTOBER_RAILWAY:     tep70_v2_sprites_right;
  LV_MOSCOW_RAILWAY:      tep70_v3_sprites_right;
  LV_BELARUSSIAN_RAILWAY: tep70_v4_sprites_right;
  LV_NORTHERN_RAILWAY:    tep70_v5_sprites_right;
  align_13_sprites;
}

switch (FEAT_TRAINS, SELF, tep70_sprites_right_a1989,
  cargo_subtype)
{
  0:                      tep70_v6_sprites_right; 
  LV_OCTOBER_RAILWAY:     tep70_v6_sprites_right; 
  LV_MOSCOW_RAILWAY:      tep70_v7_sprites_right; 
  LV_BELARUSSIAN_RAILWAY: tep70_v8_sprites_right; 
  LV_NORTHERN_RAILWAY:    tep70_v9_sprites_right; 
  LV_RZD_PID:             tep70_v10_sprites_right;
  align_13_sprites;
}

switch (FEAT_TRAINS, SELF, tep70_sprites_right,
  (build_year >= 1978) +
  (build_year >= 1989))
{
  0: tep70_v1_sprites_right;
  1: tep70_sprites_right_a1978;
     tep70_sprites_right_a1989;
}

engine_direction_template(tep70, ) 
engine_RND_direction_template(tep70, 5, 3) 
long_vehicle_sp(tep70)

switch (FEAT_TRAINS, SELF, tep70_additional_text,
  (current_year >= 1978) +
  (current_year >= 1993))
{
  0: return string(STR_PURCHASE_HINT_ENGINE, 
                   string(STR_PURCHASE_HINT_ENGINE_TYPE_PASSENGER_DIESEL_PROTOTYPE), 
                   string(STR_PURCHASE_HINT_SECTIONS_1_2), 
                   string(STR_PURCHASE_HINT_FROMTO, 1973, 1977), 
                   string(STR_PURCHASE_HINT_FACTORY_KOLOMNA));
  1: return string(STR_PURCHASE_HINT_ENGINE, 
                   string(STR_PURCHASE_HINT_ENGINE_TYPE_PASSENGER_DIESEL), 
                   string(STR_PURCHASE_HINT_SECTIONS_1_2), 
                   string(STR_PURCHASE_HINT_FROMTO, 1978, 2006), 
                   string(STR_PURCHASE_HINT_FACTORY_KOLOMNA));
     return string(STR_PURCHASE_HINT_ENGINE, 
                   string(STR_PURCHASE_HINT_ENGINE_TYPE_PASSENGER_DIESEL), 
                   string(STR_PURCHASE_HINT_SECTIONS_1), 
                   string(STR_PURCHASE_HINT_FROMTO, 1978, 2006), 
                   string(STR_PURCHASE_HINT_FACTORY_KOLOMNA));
}

livery_template(tep70_a1978, OCTOBER_RAILWAY, LV_OCTOBER_RAILWAY, LV_MOSCOW_RAILWAY, LV_BELARUSSIAN_RAILWAY, LV_NORTHERN_RAILWAY, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
livery_template(tep70_a1989, OCTOBER_RAILWAY, LV_OCTOBER_RAILWAY, LV_MOSCOW_RAILWAY, LV_BELARUSSIAN_RAILWAY, LV_NORTHERN_RAILWAY, LV_RZD_PID, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

switch (FEAT_TRAINS, SELF, tep70_cargo_subtype_text,
  build_year >= 1989)
{
  0: tep70_a1978_cargo_subtype_text;
     tep70_a1989_cargo_subtype_text;
}

livery_template_pre(tep70, 1978)
engine_diesel_1r_effect(tep70, 3, 2, 13)
engine_direction_template(tep70, _create_effect) 
engine_RND_effect_direction_template(tep70, 5, 3) 
engine_penalise_speed(tep70, 2)
engine_speed_with_reduce_and_pre_model(tep70, 160, 
                                              140, 25, 7, 1978)
engine_TE_change_build_after(tep70, get_tec_int(282.4, 129), 
                                    get_tec_int(288.3, 135), 1978)
engine_cost_change_build_after(tep70, 66, 
                                      60, 1978)
engine_weight_change_build_after(tep70, 129, 
                                      135, 1978)
engine_power_change_build_after(tep70, get_power_in_cb(3300), 
                                       get_power_in_cb(3168), 1978)
engine_ARV_change_build_after(tep70, 4, 
                                     5, 1978)
engine_RC_change_build_after(tep70, 646, 
                                    585, 1978)
                 
switch (FEAT_TRAINS, SELF, tep70_bitmask_vehicle_info_advanced1,
  build_year >= 1993)
{
  1: return FLAG_PENALISE_SPEED;
     tep70_bitmask_vehicle_info;
}    

switch (FEAT_TRAINS, SELF, tep70_bitmask_vehicle_info_advanced,
  position_in_consist == 0)
{ 
  1: return 0;                                                              
     tep70_bitmask_vehicle_info_advanced1; 
}

item (FEAT_TRAINS, tep70, 173) {
  property {
    name: string(STR_NAME_TEP70);
    climates_available: get_climates_available();
    vehicle_dates(1973, 2006, 25, 10)
    vehicle_pass()
    vehicle_diesel(3300)
    length: 8;
  }
  graphics {
    default: tep70_sprites;
    purchase: tep70_purchase_sprites;
    can_attach_wagon: any_can_attach_wagon;
    cost_factor: tep70_cost_factor;
    start_stop: any_start_stop;
    additional_text: tep70_additional_text;
    cargo_subtype_text: tep70_cargo_subtype_text_pre;
    cargo_capacity: return 0;
    power: tep70_power;
    weight: tep70_weight;
    tractive_effort_coefficient: tep70_tractive_effort_coefficient;
    articulated_part: tep70_articulated_part;
    speed: tep70_speed;
    purchase_speed: tep70_purchase_speed;
    running_cost_factor: tep70_running_cost_factor;
    bitmask_vehicle_info: tep70_bitmask_vehicle_info_advanced;
    create_effect: tep70_create_effect;
  }
}

long_name_template(tep70, STR_LONGNAME_TEP70)
models_default_cargo_template(tep70)
allow_diesel(tep70)
