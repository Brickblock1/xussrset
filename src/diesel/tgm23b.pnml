 // tgm23b

// Спрайты

// 2 окраса в зависимости от года выпуска

#define IMAGEFILE  "src/diesel/tgm23b-v-d.png"

// покупка
purchase_sprites(tgm23x, 0, 0)

// шаблон для анимации из 4-х фреймов

#define tgm23x_template(x, y, d, v) \
spriteset (tgm23x_1_##v##spriteset, IMAGEFILE) \
{ \
  s5_template(x, y, d) \
} \
 \
spriteset (tgm23x_2_##v##spriteset, IMAGEFILE) \
{ \
  s5_template(x, y+36, d) \
} \
 \
spriteset (tgm23x_3_##v##spriteset, IMAGEFILE) \
{ \
  s5_template(x, y+72, d) \
} \
 \
spriteset (tgm23x_4_##v##spriteset, IMAGEFILE) \
{ \
  s5_template(x, y+108, d) \
}

//
tgm23x_template(5, 58, 0, )
tgm23x_template(5, 205, 0, v2_)
tgm23x_template(5, 352, 0, v3_)
tgm23x_template(5, 499, 0, v4_)
tgm23x_template(5, 646, 0, v5_)
tgm23x_template(5, 793, 0, v6_)
tgm23x_template(5, 939, 0, v7_)
tgm23x_template(5, 1085, 0, v8_)
tgm23x_template(5, 1232, 0, v9_)
tgm23x_template(5, 1379, 0, v10_)
tgm23x_template(5, 1526, 0, v11_)
tgm23x_template(5, 1672, 0, v12_)
tgm23x_template(5, 1818, 0, v13_)
tgm23x_template(5, 1965, 0, v14_)
tgm23x_template(5, 2112, 0, v15_)
tgm23x_template(5, 2260, 0, v16_)
tgm23x_template(5, 2406, 0, v17_)

// x=250, r - реверс
// flipped
tgm23x_template(5, 58, -3, flipped_)
tgm23x_template(5, 205, -3, flipped_v2_)
tgm23x_template(5, 352, -3, flipped_v3_)
tgm23x_template(5, 499, -3, flipped_v4_)
tgm23x_template(5, 646, -3, flipped_v5_)
tgm23x_template(5, 793, -3, flipped_v6_)
tgm23x_template(5, 939, -3, flipped_v7_)
tgm23x_template(5, 1085, -3, flipped_v8_)
tgm23x_template(5, 1232, -3, flipped_v9_)
tgm23x_template(5, 1379, -3, flipped_v10_)
tgm23x_template(5, 1526, -3, flipped_v11_)
tgm23x_template(5, 1672, -3, flipped_v12_)
tgm23x_template(5, 1818, -3, flipped_v13_)
tgm23x_template(5, 1965, -3, flipped_v14_)
tgm23x_template(5, 2112, -3, flipped_v15_)
tgm23x_template(5, 2260, -3, flipped_v16_)
tgm23x_template(5, 2406, -3, flipped_v17_)

#undef IMAGEFILE

switch (FEAT_TRAINS, SELF, tgm23b_sprites_red1,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_spriteset;
   1: tgm23x_2_spriteset;
   2: tgm23x_3_spriteset;
   3: tgm23x_4_spriteset;
   4: tgm23x_4_flipped_spriteset;
   5: tgm23x_3_flipped_spriteset;
   6: tgm23x_2_flipped_spriteset;
   7: tgm23x_1_flipped_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_red2,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v3_spriteset;
   1: tgm23x_2_v3_spriteset;
   2: tgm23x_3_v3_spriteset;
   3: tgm23x_4_v3_spriteset;
   4: tgm23x_4_flipped_v3_spriteset;
   5: tgm23x_3_flipped_v3_spriteset;
   6: tgm23x_2_flipped_v3_spriteset;
   7: tgm23x_1_flipped_v3_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_red3,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v12_spriteset;
   1: tgm23x_2_v12_spriteset;
   2: tgm23x_3_v12_spriteset;
   3: tgm23x_4_v12_spriteset;
   4: tgm23x_4_flipped_v12_spriteset;
   5: tgm23x_3_flipped_v12_spriteset;
   6: tgm23x_2_flipped_v12_spriteset;
   7: tgm23x_1_flipped_v12_spriteset;
      align_5_sprites;
}

random_switch (FEAT_TRAINS, PARENT, tgm23b_sprites_red, 0)
{
  1: tgm23b_sprites_red1; 
  1: tgm23b_sprites_red2; 
  1: tgm23b_sprites_red3; 
}


switch (FEAT_TRAINS, SELF, tgm23b_sprites_vinous1,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v7_spriteset;
   1: tgm23x_2_v7_spriteset;
   2: tgm23x_3_v7_spriteset;
   3: tgm23x_4_v7_spriteset;
   4: tgm23x_4_flipped_v7_spriteset;
   5: tgm23x_3_flipped_v7_spriteset;
   6: tgm23x_2_flipped_v7_spriteset;
   7: tgm23x_1_flipped_v7_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_vinous2,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v8_spriteset;
   1: tgm23x_2_v8_spriteset;
   2: tgm23x_3_v8_spriteset;
   3: tgm23x_4_v8_spriteset;
   4: tgm23x_4_flipped_v8_spriteset;
   5: tgm23x_3_flipped_v8_spriteset;
   6: tgm23x_2_flipped_v8_spriteset;
   7: tgm23x_1_flipped_v8_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_vinous3,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v9_spriteset;
   1: tgm23x_2_v9_spriteset;
   2: tgm23x_3_v9_spriteset;
   3: tgm23x_4_v9_spriteset;
   4: tgm23x_4_flipped_v9_spriteset;
   5: tgm23x_3_flipped_v9_spriteset;
   6: tgm23x_2_flipped_v9_spriteset;
   7: tgm23x_1_flipped_v9_spriteset;
      align_5_sprites;
}

random_switch (FEAT_TRAINS, PARENT, tgm23b_sprites_vinous, 0)
{
  1: tgm23b_sprites_vinous1; 
  1: tgm23b_sprites_vinous2; 
  1: tgm23b_sprites_vinous3; 
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_pink,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v15_spriteset;
   1: tgm23x_2_v15_spriteset;
   2: tgm23x_3_v15_spriteset;
   3: tgm23x_4_v15_spriteset;
   4: tgm23x_4_flipped_v15_spriteset;
   5: tgm23x_3_flipped_v15_spriteset;
   6: tgm23x_2_flipped_v15_spriteset;
   7: tgm23x_1_flipped_v15_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_green1,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v4_spriteset;
   1: tgm23x_2_v4_spriteset;
   2: tgm23x_3_v4_spriteset;
   3: tgm23x_4_v4_spriteset;
   4: tgm23x_4_flipped_v4_spriteset;
   5: tgm23x_3_flipped_v4_spriteset;
   6: tgm23x_2_flipped_v4_spriteset;
   7: tgm23x_1_flipped_v4_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_green2,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v10_spriteset;
   1: tgm23x_2_v10_spriteset;
   2: tgm23x_3_v10_spriteset;
   3: tgm23x_4_v10_spriteset;
   4: tgm23x_4_flipped_v10_spriteset;
   5: tgm23x_3_flipped_v10_spriteset;
   6: tgm23x_2_flipped_v10_spriteset;
   7: tgm23x_1_flipped_v10_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_green3,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v11_spriteset;
   1: tgm23x_2_v11_spriteset;
   2: tgm23x_3_v11_spriteset;
   3: tgm23x_4_v11_spriteset;
   4: tgm23x_4_flipped_v11_spriteset;
   5: tgm23x_3_flipped_v11_spriteset;
   6: tgm23x_2_flipped_v11_spriteset;
   7: tgm23x_1_flipped_v11_spriteset;
      align_5_sprites;
}

random_switch (FEAT_TRAINS, PARENT, tgm23b_sprites_green, 0)
{
  1: tgm23b_sprites_green1; 
  1: tgm23b_sprites_green2; 
  1: tgm23b_sprites_green3; 
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_pgreen,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v2_spriteset;
   1: tgm23x_2_v2_spriteset;
   2: tgm23x_3_v2_spriteset;
   3: tgm23x_4_v2_spriteset;
   4: tgm23x_4_flipped_v2_spriteset;
   5: tgm23x_3_flipped_v2_spriteset;
   6: tgm23x_2_flipped_v2_spriteset;
   7: tgm23x_1_flipped_v2_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_blue1,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v16_spriteset;
   1: tgm23x_2_v16_spriteset;
   2: tgm23x_3_v16_spriteset;
   3: tgm23x_4_v16_spriteset;
   4: tgm23x_4_flipped_v16_spriteset;
   5: tgm23x_3_flipped_v16_spriteset;
   6: tgm23x_2_flipped_v16_spriteset;
   7: tgm23x_1_flipped_v16_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_blue2,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v17_spriteset;
   1: tgm23x_2_v17_spriteset;
   2: tgm23x_3_v17_spriteset;
   3: tgm23x_4_v17_spriteset;
   4: tgm23x_4_flipped_v17_spriteset;
   5: tgm23x_3_flipped_v17_spriteset;
   6: tgm23x_2_flipped_v17_spriteset;
   7: tgm23x_1_flipped_v17_spriteset;
      align_5_sprites;
}

random_switch (FEAT_TRAINS, PARENT, tgm23b_sprites_blue, 0)
{
  1: tgm23b_sprites_blue1; 
  1: tgm23b_sprites_blue2; 
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_lblue1,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v5_spriteset;
   1: tgm23x_2_v5_spriteset;
   2: tgm23x_3_v5_spriteset;
   3: tgm23x_4_v5_spriteset;
   4: tgm23x_4_flipped_v5_spriteset;
   5: tgm23x_3_flipped_v5_spriteset;
   6: tgm23x_2_flipped_v5_spriteset;
   7: tgm23x_1_flipped_v5_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_lblue2,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v6_spriteset;
   1: tgm23x_2_v6_spriteset;
   2: tgm23x_3_v6_spriteset;
   3: tgm23x_4_v6_spriteset;
   4: tgm23x_4_flipped_v6_spriteset;
   5: tgm23x_3_flipped_v6_spriteset;
   6: tgm23x_2_flipped_v6_spriteset;
   7: tgm23x_1_flipped_v6_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_lblue3,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v13_spriteset;
   1: tgm23x_2_v13_spriteset;
   2: tgm23x_3_v13_spriteset;
   3: tgm23x_4_v13_spriteset;
   4: tgm23x_4_flipped_v13_spriteset;
   5: tgm23x_3_flipped_v13_spriteset;
   6: tgm23x_2_flipped_v13_spriteset;
   7: tgm23x_1_flipped_v13_spriteset;
      align_5_sprites;
}

random_switch (FEAT_TRAINS, PARENT, tgm23b_sprites_lblue, 0)
{
  1: tgm23b_sprites_lblue1; 
  1: tgm23b_sprites_lblue2; 
  1: tgm23b_sprites_lblue3; 
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_yellow,
  LOAD_TEMP(3) + (is_flipped() * 4))
{
   0: tgm23x_1_v14_spriteset;
   1: tgm23x_2_v14_spriteset;
   2: tgm23x_3_v14_spriteset;
   3: tgm23x_4_v14_spriteset;
   4: tgm23x_4_flipped_v14_spriteset;
   5: tgm23x_3_flipped_v14_spriteset;
   6: tgm23x_2_flipped_v14_spriteset;
   7: tgm23x_1_flipped_v14_spriteset;
      align_5_sprites;
}

switch (FEAT_TRAINS, SELF, tgm23b_sprites_start,
  cargo_subtype)
{
  0: tgm23b_sprites_red;
  1: tgm23b_sprites_vinous;
  2: tgm23b_sprites_pink;
  3: tgm23b_sprites_green;
  4: tgm23b_sprites_pgreen;
  5: tgm23b_sprites_blue;
  6: tgm23b_sprites_lblue;
  7: tgm23b_sprites_yellow;
     align_5_sprites;
}

short_vehicle(tgm23b)

switch (FEAT_TRAINS, SELF, tgm23b_cargo_subtype_text,
  cargo_subtype)
{
  0: return string(STR_REFIT_TTD_B4);
  1: return string(STR_REFIT_TTD_B3);
  2: return string(STR_REFIT_TTD_A5);
  3: return string(STR_REFIT_TTD_53);
  4: return string(STR_REFIT_TTD_59);
  5: return string(STR_REFIT_TTD_93);
  6: return string(STR_REFIT_TTD_96);
  7: return string(STR_REFIT_TTD_42);
     return CB_RESULT_NO_TEXT;
}

engine_speed(tgm23b, 60)

engine_penalise_speed0(tgm23b)

general_running_cost(tgm23b, 6)

item (FEAT_TRAINS, tgm23b)
{
  property {
    name: string(STR_TGM23B_NAME);
    climates_available: get_climates_available();
    introduction_date: date(get_loc_year(1973), 1, 1);
    vehicle_life: 20;
    model_life: get_model_life(1973,1985);
    retire_early: get_retire_early(1973,1985);
    reliability_decay: 20;
    cargo_allow_refit: [GOOD];
    default_cargo_type: GOOD;
    cost_factor: 6;
    sprite_id: SPRITE_ID_NEW_TRAIN; 
    speed: 60 km/h;
    misc_flags: bitmask(TRAIN_FLAG_FLIP);
    track_type: get_normal_track_type();
    power: 230 hpM;
    running_cost_base: RUNNING_COST_DIESEL;
    cargo_capacity: 1;
    weight: 44 ton;
    engine_class: ENGINE_CLASS_DIESEL;
    tractive_effort_coefficient: get_tec(50.0, 44);
    length: 4;
    visual_effect_and_powered: diesel_visual_effect_and_powered(0);
  }
  graphics {
    default: tgm23b_sprites;
    purchase: tgm23x_purchase_sprites;
    can_attach_wagon: any_can_attach_wagon;
    start_stop: any_start_stop;
    articulated_part: articulated_part_dummy1;
    speed: tgm23b_speed;
    purchase_speed: tgm23b_purchase_speed;
    running_cost_factor: tgm23b_running_cost_factor;
    additional_text: return string(STR_TGM23B_PURCHASE_HINT);
    cargo_subtype_text: tgm23b_cargo_subtype_text;
    cargo_capacity: return 0;
    bitmask_vehicle_info: tgm23b_bitmask_vehicle_info;
  }
}

if (enable_long_names) {
  item (FEAT_TRAINS, tgm23b)
  {
    property { name: string(STR_TGM23B_NAME_LONG); }
  }
}

