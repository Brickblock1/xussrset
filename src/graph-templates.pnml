 /// graphics definition

// Определение спрайта меню покупки

#define purchase_sprites(name, x, y)                               \
spriteset (name##_purchase_graphics_ico, IMAGEFILE)                \
{ [x, y, 100, 18, -40, -13] }                                      \
spriteset (name##_purchase_graphics_noico, IMAGEFILE)              \
{ [x+18, y, 82, 18, -40, -13] }                                    \
switch (FEAT_TRAINS, SELF, name##_purchase_sprites,                \
  enable_icons)                                                    \
{  1: name##_purchase_graphics_ico;                                \
      name##_purchase_graphics_noico;}                             \

// Паровоз
#define steam_sprites(n, name, x, y)                                                   \
spriteset (name##_notpowered_sprites_1_left, IMAGEFILE)                                \
{ s##n##_template(x, y, 0) }                                                           \
spriteset (name##_notpowered_sprites_2_left, IMAGEFILE)                                \
{ s##n##_template(x, y+67, 0) }                                                        \
spriteset (name##_notpowered_sprites_3_left, IMAGEFILE)                                \
{ s##n##_template(x, y+134, 0) }                                                       \
spriteset (name##_notpowered_sprites_4_left, IMAGEFILE)                                \
{ s##n##_template(x, y+201, 0) }                                                       \
spriteset (name##_loading_sprites_1_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+268, 0) }                                                       \
spriteset (name##_loading_sprites_2_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+335, 0) }                                                       \
spriteset (name##_loading_sprites_3_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+402, 0) }                                                       \
spriteset (name##_loading_sprites_4_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+469, 0) }                                                       \
spriteset (name##_traveling_sprites_1_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+536, 0) }                                                       \
spriteset (name##_traveling_sprites_2_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+603, 0) }                                                       \
spriteset (name##_traveling_sprites_3_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+670, 0) }                                                       \
spriteset (name##_traveling_sprites_4_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+737, 0) }                                                       \
spritegroup name##_normal_sprites_1_left                                               \
{ loading: name##_loading_sprites_1_left;                                              \
  loaded: name##_traveling_sprites_1_left; }                                           \
spritegroup name##_normal_sprites_2_left                                               \
{ loading: name##_loading_sprites_2_left;                                              \
  loaded: name##_traveling_sprites_2_left; }                                           \
spritegroup name##_normal_sprites_3_left                                               \
{ loading: name##_loading_sprites_3_left;                                              \
  loaded: name##_traveling_sprites_3_left; }                                           \
spritegroup name##_normal_sprites_4_left                                               \
{ loading: name##_loading_sprites_4_left;                                              \
  loaded: name##_traveling_sprites_4_left; }                                           \
switch (FEAT_TRAINS, SELF, name##_notpowered_sprites_left, LOAD_TEMP(3))               \
{ 0: name##_notpowered_sprites_1_left;                                                 \
  1: name##_notpowered_sprites_2_left;                                                 \
  2: name##_notpowered_sprites_3_left;                                                 \
     name##_notpowered_sprites_4_left; }                                               \
switch (FEAT_TRAINS, SELF, name##_normal_sprites_left, LOAD_TEMP(3))                   \
{ 0: name##_normal_sprites_1_left;                                                     \
  1: name##_normal_sprites_2_left;                                                     \
  2: name##_normal_sprites_3_left;                                                     \
     name##_normal_sprites_4_left; }                                                   \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                        \
  (position_in_consist == 0) && (!(vehicle_is_not_powered || vehicle_is_in_depot)) )   \
{ 1: name##_normal_sprites_left;                                                       \
     name##_notpowered_sprites_left; }                                                 \

// Тендер
#define tender_sprites(n, name, x, y)                                                  \
spriteset (name##_sprites_left, IMAGEFILE)                                             \
{ s##n##_template(x, y, 0) }                                                           \

// Бустер
#define buster_sprites(n, name, x, y)                                                  \
spriteset (name##_sprites_left, IMAGEFILE)                                             \
{ s##n##_template(x, y, 0) }                                                           \
spriteset (name##_sprites_right, IMAGEFILE)                                            \
{ s##n##_r_template(x, y, 0) }                                                         \

/*
// 1-о секционный тепловоз симметричный
#define diesel1s_sprites(n, name, x, y)                                              \
spriteset (name##_notpowered_sprites, IMAGEFILE)                                     \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites, IMAGEFILE)                                        \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_normal_sprites                                                    \
{ loading: name##_loading_sprites;                                                   \
  loaded: name##_traveling_sprites; }                                                \
switch (FEAT_TRAINS, SELF, name##_sprites,                                           \
  (position_in_consist == 0) && (!(vehicle_is_not_powered || vehicle_is_in_depot)) ) \
{ 1: name##_normal_sprites;                                                          \
     name##_notpowered_sprites; }                                                    \
*/

// 1-о секционный тепловоз несимметричный 
#define diesel1r_sprites(n, name, x, y)                                              \
spriteset (name##_notpowered_sprites_left, IMAGEFILE)                                \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_normal_sprites_left                                               \
{ loading: name##_loading_sprites_left;                                              \
  loaded: name##_traveling_sprites_left; }                                           \
spriteset (name##_notpowered_sprites_right, IMAGEFILE)                               \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_loading_sprites_right, IMAGEFILE)                                  \
{ s##n##_r_template(x+415, y+67, 0) }                                                \
spriteset (name##_traveling_sprites_right, IMAGEFILE)                                \
{ s##n##_r_template(x+415, y+134, 0) }                                               \
spritegroup name##_normal_sprites_right                                              \
{ loading: name##_loading_sprites_right;                                             \
  loaded: name##_traveling_sprites_right; }                                          \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  (position_in_consist == 0) && (!(vehicle_is_not_powered || vehicle_is_in_depot)) ) \
{ 1: name##_normal_sprites_left;                                                     \
     name##_notpowered_sprites_left; }                                               \
switch (FEAT_TRAINS, SELF, name##_sprites_right,                                     \
  (position_in_consist == 0) && (!(vehicle_is_not_powered || vehicle_is_in_depot)) ) \
{ 1: name##_normal_sprites_right;                                                    \
     name##_notpowered_sprites_right; }                                              \

// 2-х секционный тепловоз или 1-о секционный тепловоз несимметричный без фонарей сзади
#define diesel2_sprites(n, name, x, y)                                               \
spriteset (name##_notpowered_sprites_left, IMAGEFILE)                                \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites_left, IMAGEFILE)                                   \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites_left, IMAGEFILE)                                 \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_normal_sprites_left                                               \
{ loading: name##_loading_sprites_left;                                              \
  loaded: name##_traveling_sprites_left; }                                           \
spriteset (name##_sprites_right, IMAGEFILE)                                          \
{ s##n##_r_template(x, y, 0) }                                                       \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  (position_in_consist == 0) && (!(vehicle_is_not_powered || vehicle_is_in_depot)) ) \
{ 1: name##_normal_sprites_left;                                                     \
     name##_notpowered_sprites_left; }                                               \

// 1-осекционный электровоз с 2 пантографами
#define electric1_2_sprites(n, name, x, y)                                           \
spriteset (name##_notpowered_sprites, IMAGEFILE)                                     \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites, IMAGEFILE)                                        \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_normal_sprites                                                    \
{ loading: name##_loading_sprites;                                                   \
  loaded: name##_traveling_sprites; }                                                \
spriteset (name##_speedoverTH_sprites, IMAGEFILE)                                    \
{ s##n##_template(x, y+201, 0) }                                                     \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  ((LOAD_TEMP(1) > threshold_of_speed()) + 1) *                                      \
  ((position_in_consist > 0) * 2 + 1) *                                              \
  (!(vehicle_is_not_powered || vehicle_is_in_depot)) )                               \
{ 1: name##_normal_sprites;                                                          \
  2: name##_speedoverTH_sprites;                                                     \
  3: name##_loading_sprites;                                                         \
     name##_notpowered_sprites; }                                                    \

// 2-хсекционный электровоз с 2 пантографами
#define electric2_2_sprites(n, name, x, y)                                           \
spriteset (name##_notpowered_sprites_left_d_all_up, IMAGEFILE)                       \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites_left_all_up, IMAGEFILE)                            \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites_left_2_up, IMAGEFILE)                            \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_notpowered_sprites_left_d_down, IMAGEFILE)                         \
{ s##n##_template(x+415, y, 0) }                                                     \
spriteset (name##_traveling_sprites_left_d_2_up, IMAGEFILE)                          \
{ s##n##_template(x+415, y+134, 0) }                                                 \
spriteset (name##_notpowered_sprites_right_d_all_up, IMAGEFILE)                      \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_notpowered_sprites_right_d_down, IMAGEFILE)                        \
{ s##n##_r_template(x+415, y, 0) }                                                   \
spriteset (name##_notpowered_sprites_right_d_1_up, IMAGEFILE)                        \
{ s##n##_r_template(x+415, y+67, 0) }                                                \
spritegroup name##_normal_sprites_1st_left                                           \
{ loading: name##_loading_sprites_left_all_up;                                       \
  loaded: name##_traveling_sprites_left_2_up; }                                      \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  ((LOAD_TEMP(1) > threshold_of_speed()) + (position_in_consist > 0) * 2 + 1) *      \
  (!(vehicle_is_not_powered || vehicle_is_in_depot)) )                               \
{ 1..2: name##_normal_sprites_1st_left;                                              \
  3: name##_notpowered_sprites_left_d_all_up;                                        \
  4: name##_traveling_sprites_left_d_2_up;                                           \
     name##_notpowered_sprites_left_d_down; }                                        \
switch (FEAT_TRAINS, SELF, name##_sprites_right,                                     \
  ((LOAD_TEMP(1) > threshold_of_speed()) + 1) *                                      \
  (!(vehicle_is_not_powered || vehicle_is_in_depot)) )                               \
{ 1: name##_notpowered_sprites_right_d_all_up;                                       \
  2: name##_notpowered_sprites_right_d_1_up;                                         \
     name##_notpowered_sprites_right_d_down; }                                       \

// 2-хсекционный электровоз с 1 пантографом
#define electric2_1_sprites(n, name, x, y)                                           \
spriteset (name##_notpowered_sprites_left_up, IMAGEFILE)                             \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites_left_up, IMAGEFILE)                                \
{ s##n##_template(x, y+67, 0) }                                                      \
spriteset (name##_traveling_sprites_left_up, IMAGEFILE)                              \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_notpowered_sprites_left_down, IMAGEFILE)                           \
{ s##n##_template(x+415, y, 0) }                                                     \
spriteset (name##_traveling_sprites_left_down, IMAGEFILE)                            \
{ s##n##_template(x+415, y+134, 0) }                                                 \
spriteset (name##_notpowered_sprites_right_up, IMAGEFILE)                            \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_notpowered_sprites_right_down, IMAGEFILE)                          \
{ s##n##_r_template(x+415, y, 0) }                                                   \
spritegroup name##_normal_sprites_left                                               \
{ loading: name##_loading_sprites_left_up;                                           \
  loaded: name##_traveling_sprites_left_up; }                                        \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  ((LOAD_TEMP(1) > threshold_of_speed()) + (position_in_consist > 0) * 2 + 1) *      \
  (!(vehicle_is_not_powered || vehicle_is_in_depot)) )                               \
{ 1: name##_normal_sprites_left;                                                     \
  2: name##_traveling_sprites_left_down;                                             \
  3: name##_notpowered_sprites_left_up;                                              \
     name##_notpowered_sprites_left_down; }                                          \
switch (FEAT_TRAINS, SELF, name##_sprites_right,                                     \
  (!(vehicle_is_not_powered || vehicle_is_in_depot)) )                               \
{ 1: name##_notpowered_sprites_right_up;                                             \
     name##_notpowered_sprites_right_down; }                                         \

// Для всех ЭМВПС если голова неверная, то тяги нет по определению - проверка неверной головы не предполагается

// МВПС 2 головных без отдельного реверса (промежуточные головные)
#define MU_2_0_0_sprites(n, name, x, y)                                              \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_h_sprites_left                                                    \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_notpowered_sprites_left; }                                        \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x, y+134, 0) }                                                   \
spritegroup name##_h_sprites_right                                                   \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_notpowered_sprites_right; }                                       \

// МВПС 2 головных с отдельным реверсом (промежуточные головные)
#define MU_2r_0_0_sprites(n, name, x, y)                                             \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_h_sprites_left                                                    \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_notpowered_sprites_left; }                                        \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+32, y+67, 0) }                                                 \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+32, y+201, 0) }                                                \
spritegroup name##_h_sprites_right                                                   \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_notpowered_sprites_right; }                                       \

// МВПС 3 головных без отдельного реверса
#define MU_3_0_0_sprites(n, name, x, y)                                              \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_h_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x, y+268, 0) }                                                     \
spritegroup name##_h_normal_sprites                                                  \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_traveling_sprites; }                                              \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x, y+134, 0) }                                                   \
spriteset (name##_h_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x, y+268, 0) }                                                   \
spritegroup name##_h_r_normal_sprites                                                \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_r_traveling_sprites; }                                            \
switch (FEAT_TRAINS, SELF, name##_h_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_normal_sprites;                                                        \
     name##_h_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_h_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_r_normal_sprites;                                                      \
     name##_h_notpowered_sprites_right; }                                            \
                                                                                     \
// МВПС 3 головных с отдельным реверсом 
#define MU_3r_0_0_sprites(n, name, x, y)                                             \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_h_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x, y+268, 0) }                                                     \
spritegroup name##_h_normal_sprites                                                  \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_traveling_sprites; }                                              \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+32, y+67, 0) }                                                 \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+32, y+201, 0) }                                                \
spriteset (name##_h_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+32, y+335, 0) }                                                \
spritegroup name##_h_r_normal_sprites                                                \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_r_traveling_sprites; }                                            \
switch (FEAT_TRAINS, SELF, name##_h_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_normal_sprites;                                                        \
     name##_h_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_h_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_r_normal_sprites;                                                      \
     name##_h_notpowered_sprites_right; }                                            \

// МВПС 4 головных без отдельного реверса (Промежуточные головы)
#define MU_4_0_0_sprites(n, name, x, y)                                              \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_h_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x, y+268, 0) }                                                     \
spriteset (name##_h_notpowered_loading_sprites, IMAGEFILE)                           \
{ s##n##_template(x, y+402, 0) }                                                     \
spritegroup name##_h_normal_sprites                                                  \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_traveling_sprites; }                                              \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x, y, 0) }                                                       \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x, y+134, 0) }                                                   \
spriteset (name##_h_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x, y+268, 0) }                                                   \
spriteset (name##_h_r_notpowered_loading_sprites, IMAGEFILE)                         \
{ s##n##_r_template(x, y+402, 0) }                                                   \
spritegroup name##_h_r_normal_sprites                                                \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_r_traveling_sprites; }                                            \
spritegroup name##_h_notpowered_normal_sprites_left                                  \
{ loading: name##_h_notpowered_loading_sprites;                                      \
  loaded: name##_h_notpowered_sprites_left; }                                        \
spritegroup name##_h_notpowered_normal_sprites_right                                 \
{ loading: name##_h_r_notpowered_loading_sprites;                                    \
  loaded: name##_h_notpowered_sprites_right; }                                       \
switch (FEAT_TRAINS, SELF, name##_h_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_normal_sprites;                                                        \
     name##_h_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_h_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_r_normal_sprites;                                                      \
     name##_h_notpowered_sprites_right; }                                            \
                                                                                     \
// МВПС 4 головных с отдельным реверсом (Промежуточные головы)
#define MU_4r_0_0_sprites(n, name, x, y)                                             \
spriteset (name##_h_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_h_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x, y+134, 0) }                                                     \
spriteset (name##_h_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x, y+268, 0) }                                                     \
spriteset (name##_h_notpowered_loading_sprites, IMAGEFILE)                           \
{ s##n##_template(x, y+402, 0) }                                                     \
spritegroup name##_h_normal_sprites                                                  \
{ loading: name##_h_loading_sprites;                                                 \
  loaded: name##_h_traveling_sprites; }                                              \
spriteset (name##_h_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+32, y+67, 0) }                                                 \
spriteset (name##_h_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+32, y+201, 0) }                                                \
spriteset (name##_h_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+32, y+335, 0) }                                                \
spriteset (name##_h_r_notpowered_loading_sprites, IMAGEFILE)                         \
{ s##n##_r_template(x+32, y+469, 0) }                                                \
spritegroup name##_h_r_normal_sprites                                                \
{ loading: name##_h_r_loading_sprites;                                               \
  loaded: name##_h_r_traveling_sprites; }                                            \
spritegroup name##_h_notpowered_normal_sprites_left                                  \
{ loading: name##_h_notpowered_loading_sprites;                                      \
  loaded: name##_h_notpowered_sprites_left; }                                        \
spritegroup name##_h_notpowered_normal_sprites_right                                 \
{ loading: name##_h_r_notpowered_loading_sprites;                                    \
  loaded: name##_h_notpowered_sprites_right; }                                       \
switch (FEAT_TRAINS, SELF, name##_h_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_normal_sprites;                                                        \
     name##_h_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_h_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_h_r_normal_sprites;                                                      \
     name##_h_notpowered_sprites_right; }                                            \

// МВПС 2 мотоных без отдельного реверса (двусистемные МВПС) (погрузка не производится)
#define MU_0_2nl_0_sprites(n, name, x, y)                                            \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+447, y, 0) }                                                   \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+447, y+268, 0) }                                               \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_traveling_sprites;                                                     \
     name##_m_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_traveling_sprites;                                                   \
     name##_m_notpowered_sprites_right; }                                            \
// МВПС 2 мотоных с отдельным реверсом (двусистемные МВПС) (погрузка не производится)
#define MU_0_2nlr_0_sprites(n, name, x, y)                                           \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+479, y+67, 0) }                                                \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+479, y+335, 0) }                                               \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_traveling_sprites;                                                     \
     name##_m_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_traveling_sprites;                                                   \
     name##_m_notpowered_sprites_right; }                                            \

// МВПС 3 мотоных без отдельного реверса
#define MU_0_3_0_sprites(n, name, x, y)                                              \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+447, y+134, 0) }                                                 \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spritegroup name##_m_normal_sprites                                                  \
{ loading: name##_m_loading_sprites;                                                 \
  loaded: name##_m_traveling_sprites; }                                              \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+447, y, 0) }                                                   \
spriteset (name##_m_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+447, y+134, 0) }                                               \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+447, y+268, 0) }                                               \
spritegroup name##_m_r_normal_sprites                                                \
{ loading: name##_m_r_loading_sprites;                                               \
  loaded: name##_m_r_traveling_sprites; }                                            \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_normal_sprites;                                                        \
     name##_m_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_normal_sprites;                                                      \
     name##_m_notpowered_sprites_right; }                                            \

// МВПС 3 мотоных с отдельным реверсом 
#define MU_0_3r_0_sprites(n, name, x, y)                                             \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+447, y+134, 0) }                                                 \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spritegroup name##_m_normal_sprites                                                  \
{ loading: name##_m_loading_sprites;                                                 \
  loaded: name##_m_traveling_sprites; }                                              \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+479, y+67, 0) }                                                \
spriteset (name##_m_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+479, y+201, 0) }                                               \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+479, y+335, 0) }                                               \
spritegroup name##_m_r_normal_sprites                                                \
{ loading: name##_m_r_loading_sprites;                                               \
  loaded: name##_m_r_traveling_sprites; }                                            \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_normal_sprites;                                                        \
     name##_m_notpowered_sprites_left; }                                             \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_normal_sprites;                                                      \
     name##_m_notpowered_sprites_right; }                                            \

// МВПС 4 мотоных без отдельного реверса (двусистемные МВПС)
#define MU_0_4_0_sprites(n, name, x, y)                                              \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+447, y+134, 0) }                                                 \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spriteset (name##_m_notpowered_loading_sprites, IMAGEFILE)                           \
{ s##n##_template(x+447, y+402, 0) }                                                 \
spritegroup name##_m_normal_sprites                                                  \
{ loading: name##_m_loading_sprites;                                                 \
  loaded: name##_m_traveling_sprites; }                                              \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+447, y, 0) }                                                   \
spriteset (name##_m_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+447, y+134, 0) }                                               \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+447, y+268, 0) }                                               \
spriteset (name##_m_r_notpowered_loading_sprites, IMAGEFILE)                         \
{ s##n##_r_template(x+447, y+402, 0) }                                               \
spritegroup name##_m_r_normal_sprites                                                \
{ loading: name##_m_r_loading_sprites;                                               \
  loaded: name##_m_r_traveling_sprites; }                                            \
spritegroup name##_m_notpowered_normal_sprites_left                                  \
{ loading: name##_m_notpowered_loading_sprites;                                      \
  loaded: name##_m_notpowered_sprites_left; }                                        \
spritegroup name##_m_notpowered_normal_sprites_right                                 \
{ loading: name##_m_r_notpowered_loading_sprites;                                    \
  loaded: name##_m_notpowered_sprites_right; }                                       \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_normal_sprites;                                                        \
     name##_m_notpowered_normal_sprites_left; }                                      \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_normal_sprites;                                                      \
     name##_m_notpowered_normal_sprites_right; }                                     \

// МВПС 4 мотоных с отдельным реверсом (двусистемные МВПС)
#define MU_0_4r_0_sprites(n, name, x, y)                                             \
spriteset (name##_m_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_m_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+447, y+134, 0) }                                                 \
spriteset (name##_m_traveling_sprites, IMAGEFILE)                                    \
{ s##n##_template(x+447, y+268, 0) }                                                 \
spriteset (name##_m_notpowered_loading_sprites, IMAGEFILE)                           \
{ s##n##_template(x+447, y+402, 0) }                                                 \
spritegroup name##_m_normal_sprites                                                  \
{ loading: name##_m_loading_sprites;                                                 \
  loaded: name##_m_traveling_sprites; }                                              \
spriteset (name##_m_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+479, y+67, 0) }                                                \
spriteset (name##_m_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+479, y+201, 0) }                                               \
spriteset (name##_m_r_traveling_sprites, IMAGEFILE)                                  \
{ s##n##_r_template(x+479, y+335, 0) }                                               \
spriteset (name##_m_r_notpowered_loading_sprites, IMAGEFILE)                         \
{ s##n##_r_template(x+479, y+469, 0) }                                               \
spritegroup name##_m_r_normal_sprites                                                \
{ loading: name##_m_r_loading_sprites;                                               \
  loaded: name##_m_r_traveling_sprites; }                                            \
spritegroup name##_m_notpowered_normal_sprites_left                                  \
{ loading: name##_m_notpowered_loading_sprites;                                      \
  loaded: name##_m_notpowered_sprites_left; }                                        \
spritegroup name##_m_notpowered_normal_sprites_right                                 \
{ loading: name##_m_r_notpowered_loading_sprites;                                    \
  loaded: name##_m_notpowered_sprites_right; }                                       \
switch (FEAT_TRAINS, SELF, name##_m_sprites_left,                                    \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_normal_sprites;                                                        \
     name##_m_notpowered_normal_sprites_left; }                                      \
switch (FEAT_TRAINS, SELF, name##_m_sprites_right,                                   \
  vehicle_is_not_powered || vehicle_is_in_depot)                                     \
{ 0: name##_m_r_normal_sprites;                                                      \
     name##_m_notpowered_normal_sprites_right; }                                     \

// МВПС 1 немоторных без отдельного реверса (погрузка не производится)
#define MU_0_0_1_sprites(n, name, x, y)                                              \
spriteset (name##_c_sprites_left, IMAGEFILE)                                         \
{ s##n##_template(x+894, y, 0) }                                                     \
spriteset (name##_c_sprites_right, IMAGEFILE)                                        \
{ s##n##_r_template(x+894, y, 0) }                                                   \
                                                                                     \
// МВПС 1 немоторных с отдельным реверсом (погрузка не производится)
#define MU_0_0_1r_sprites(n, name, x, y)                                             \
spriteset (name##_c_sprites_left, IMAGEFILE)                                         \
{ s##n##_template(x+894, y, 0) }                                                     \
spriteset (name##_c_sprites_right, IMAGEFILE)                                        \
{ s##n##_r_template(x+926, y+67, 0) }                                                \
                                                                                     \
// МВПС 2 немоторных без отдельного реверса
#define MU_0_0_2_sprites(n, name, x, y)                                              \
spriteset (name##_c_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+894, y, 0) }                                                     \
spriteset (name##_c_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+894, y+134, 0) }                                                 \
spritegroup name##_c_sprites_left                                                    \
{ loading: name##_c_loading_sprites;                                                 \
  loaded: name##_c_notpowered_sprites_left; }                                        \
spriteset (name##_c_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+894, y, 0) }                                                   \
spriteset (name##_c_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+894, y+134, 0) }                                               \
spritegroup name##_c_sprites_right                                                   \
{ loading: name##_c_r_loading_sprites;                                               \
  loaded: name##_c_notpowered_sprites_right; }                                       \

// МВПС 2 немоторных с отдельным реверсом
#define MU_0_0_2r_sprites(n, name, x, y)                                             \
spriteset (name##_c_notpowered_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+894, y, 0) }                                                     \
spriteset (name##_c_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+894, y+134, 0) }                                                 \
spritegroup name##_c_sprites_left                                                    \
{ loading: name##_c_loading_sprites;                                                 \
  loaded: name##_c_notpowered_sprites_left; }                                        \
spriteset (name##_c_notpowered_sprites_right, IMAGEFILE)                             \
{ s##n##_r_template(x+926, y+67, 0) }                                                \
spriteset (name##_c_r_loading_sprites, IMAGEFILE)                                    \
{ s##n##_r_template(x+926, y+201, 0) }                                               \
spritegroup name##_c_sprites_right                                                   \
{ loading: name##_c_r_loading_sprites;                                               \
  loaded: name##_c_notpowered_sprites_right; }                                       \

// Вагоны пассажирские. 2 вида (погрузка/в пути) и отдельный вид последнего вагона                  
#define pass_wagon_sprites(n, name, x, y)                                            \
spriteset (name##_transit_sprites_left, IMAGEFILE)                                   \
{ s##n##_template(x, y, 0) }                                                         \
spriteset (name##_loading_sprites, IMAGEFILE)                                        \
{ s##n##_template(x, y+134, 0) }                                                     \
spritegroup name##_normal_sprites                                                    \
{ loading: name##_loading_sprites;                                                   \
  loaded: name##_transit_sprites_left; }                                             \
spriteset (name##_transit_sprites_right, IMAGEFILE)                                  \
{ s##n##_template(x+32, y+67, 0) }                                                   \
spriteset (name##_r_loading_sprites, IMAGEFILE)                                      \
{ s##n##_template(x+32, y+201, 0) }                                                  \
spritegroup name##_r_normal_sprites                                                  \
{ loading: name##_r_loading_sprites;                                                 \
  loaded: name##_transit_sprites_right; }                                            \
spriteset (name##_last_transit_sprites_left, IMAGEFILE)                              \
{ s##n##_template(x+447, y, 0) }                                                     \
spriteset (name##_last_loading_sprites, IMAGEFILE)                                   \
{ s##n##_template(x+447, y+134, 0) }                                                 \
spritegroup name##_last_normal_sprites                                               \
{ loading: name##_last_loading_sprites;                                              \
  loaded: name##_last_transit_sprites_left; }                                        \
spriteset (name##_last_transit_sprites_right, IMAGEFILE)                             \
{ s##n##_template(x+479, y+67, 0) }                                                  \
spriteset (name##_last_r_loading_sprites, IMAGEFILE)                                 \
{ s##n##_template(x+479, y+201, 0) }                                                 \
spritegroup name##_last_r_normal_sprites                                             \
{ loading: name##_last_r_loading_sprites;                                            \
  loaded: name##_last_transit_sprites_right; }                                       \
switch (FEAT_TRAINS, SELF, name##_sprites_left,                                      \
  position_in_consist_from_end == 1)                                                 \
{ 0: name##_normal_sprites;                                                          \
     name##_last_normal_sprites; }                                                   \
switch (FEAT_TRAINS, SELF, name##_sprites_right,                                     \
  position_in_consist_from_end == 1)                                                 \
{ 0: name##_r_normal_sprites;                                                        \
     name##_last_r_normal_sprites; }                                                 \

// Полувагоны, платформы.
// шаблон пустого вагона
#define flatbed_empty_layout_template(name, size, x, y)                              \
spriteset (name##_empty_sprites_left, IMAGEFILE)                                     \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_empty_sprites_right, IMAGEFILE)                                    \
{ s##size##_r_template(x, y, 0) }                                                    \

// шаблон груза, 2 ливреи, 3 вида загруженности
// 25-49%, 50-74%, полный
#define flatbed_horisontal_short_layout3_template(name, size, x, y, cargo)           \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_2_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x+298, y, 0) }                                                  \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x+596, y, 0) }                                                  \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_2_sprites_right, IMAGEFILE)                              \
{ s##size##_template(x+298, y, 0) }                                                  \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_template(x+596, y, 0) }                                                  \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \

// шаблон груза, 2 ливреи, 3 вида загруженности
// 25-49%, 50-74%, полный
#define flatbed_horisontal_short_layout2_template(name, size, x, y, cargo)           \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x+240, y, 0) }                                                  \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_template(x+240, y, 0) }                                                  \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \

// шаблон груза, 3 вида загруженности
#define flatbed_layout3_template(name, size, x, y, cargo)                            \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_2_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y+75, 0) }                                                   \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x, y+150, 0) }                                                  \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_##cargo##_2_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+75, 0) }                                                 \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_r_template(x, y+150, 0) }                                                \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \
                                                                                                     
// шаблон груза, 3 вида загруженности. Модифицированный 
#define flatbed_layout3_templateM(name, size, x, y, cargo)                           \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_2_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y+75, 0) }                                                   \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x, y+150, 0) }                                                  \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_2_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_##cargo##_2_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+75, 0) }                                                 \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_r_template(x, y+150, 0) }                                                \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_2_sprites_right,                                                \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \
                                                                                                     
// шаблон груза, 2 вида загруженности                                                                 
#define flatbed_layout2_template(name, size, x, y, cargo)                            \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x, y+75, 0) }                                                   \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_r_template(x, y+75, 0) }                                                 \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \
                                                                                               
// шаблон груза, 2 вида загруженности 2                                                        
#define flatbed_layout2_template2(name, size, x, y, cargo)                           \
spriteset (name##_##cargo##_1_sprites_left, IMAGEFILE)                               \
{ s##size##_template(x, y+150, 0) }                                                  \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x, y+75, 0) }                                                   \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_1_sprites_left,                                                 \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_1_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+150, 0) }                                                \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_r_template(x, y+75, 0) }                                                 \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_1_sprites_right,                                                \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \
                                                                                           
// шаблон груза, 1 вид загруженности                                                         
#define flatbed_layout1_template(name, size, x, y, cargo)                            \
spriteset (name##_##cargo##_full_sprites_left, IMAGEFILE)                            \
{ s##size##_template(x, y, 0) }                                                      \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left];                                             \
  loaded: [name##_empty_sprites_left,                                                \
    name##_##cargo##_full_sprites_left,                                              \
    name##_##cargo##_full_sprites_left]; }                                           \
spriteset (name##_##cargo##_full_sprites_right, IMAGEFILE)                           \
{ s##size##_r_template(x, y, 0) }                                                    \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right];                                            \
  loaded: [name##_empty_sprites_right,                                               \
    name##_##cargo##_full_sprites_right,                                             \
    name##_##cargo##_full_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \

// шаблон пустого крытого вагона                                              
#define box_empty_layout_template(name, size, x, y)                                  \
spriteset (name##_transit_sprites_left, IMAGEFILE)                                   \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_empty_sprites_left, IMAGEFILE)                                     \
{ s##size##_template(x, y+67, 0) }                                                   \
spriteset (name##_transit_sprites_right, IMAGEFILE)                                  \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_empty_sprites_right, IMAGEFILE)                                    \
{ s##size##_r_template(x, y+67, 0) }                                                 \

// шаблон: движение/100%, 30%, 60%, 90%                                              
#define box_layout_template(name, size, x, y, cargo)                                 \
spriteset (name##_2_##cargo##_sprites, IMAGEFILE)                                    \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_3_##cargo##_sprites, IMAGEFILE)                                    \
{ s##size##_template(x, y+67, 0) }                                                   \
spritegroup name##_##cargo##_sprites_left                                            \
{ loading: [name##_empty_sprites_left,                                               \
    name##_empty_sprites_left,                                                       \
    name##_empty_sprites_left,                                                       \
    name##_2_##cargo##_sprites,                                                      \
    name##_2_##cargo##_sprites,                                                      \
    name##_2_##cargo##_sprites,                                                      \
    name##_3_##cargo##_sprites,                                                      \
    name##_3_##cargo##_sprites,                                                      \
    name##_3_##cargo##_sprites,                                                      \
    name##_transit_sprites_left];                                                    \
  loaded: [name##_transit_sprites_left]; }                                           \
spriteset (name##_2_r_##cargo##_sprites, IMAGEFILE)                                  \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_3_r_##cargo##_sprites, IMAGEFILE)                                  \
{ s##size##_r_template(x, y+67, 0) }                                                 \
spritegroup name##_##cargo##_sprites_right                                           \
{ loading: [name##_empty_sprites_right,                                              \
    name##_empty_sprites_right,                                                      \
    name##_empty_sprites_right,                                                      \
    name##_2_r_##cargo##_sprites,                                                    \
    name##_2_r_##cargo##_sprites,                                                    \
    name##_2_r_##cargo##_sprites,                                                    \
    name##_3_r_##cargo##_sprites,                                                    \
    name##_3_r_##cargo##_sprites,                                                    \
    name##_3_r_##cargo##_sprites,                                                    \
    name##_transit_sprites_right];                                                   \
  loaded: [name##_transit_sprites_right]; }                                          \
random_switch (FEAT_TRAINS, SELF, name##_##cargo##_sprites,                          \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_##cargo##_sprites_left;                                                  \
  1: name##_##cargo##_sprites_right; }                                               \

// шаблон вагона рефсекции. Рефсекция обращается только целиком, bitmask(TRIGGER_VEHICLE_SERVICE) не является частью шаблона
#define refsection_layout_template(name, size, x, y, cargo)                          \
spriteset (name##_##cargo##_sprites_left0, IMAGEFILE)                                \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_1_##cargo##_sprites, IMAGEFILE)                                    \
{ s##size##_template(x, y+67, 0) }                                                   \
spriteset (name##_2_##cargo##_sprites, IMAGEFILE)                                    \
{ s##size##_template(x, y+134, 0) }                                                  \
spriteset (name##_3_##cargo##_sprites, IMAGEFILE)                                    \
{ s##size##_template(x, y+201, 0) }                                                  \
spritegroup name##_##cargo##_sprites_left1                                           \
{ loading: [name##_1_##cargo##_sprites];                                             \
  loaded: [name##_##cargo##_sprites_left0]; }                                        \
spritegroup name##_##cargo##_sprites_left2                                           \
{ loading: [name##_2_##cargo##_sprites];                                             \
  loaded: [name##_##cargo##_sprites_left0]; }                                        \
spritegroup name##_##cargo##_sprites_left3                                           \
{ loading: [name##_3_##cargo##_sprites];                                             \
  loaded: [name##_##cargo##_sprites_left0]; }                                        \
spriteset (name##_##cargo##_sprites_right0, IMAGEFILE)                               \
{ s##size##_r_template(x, y, 0) }                                                    \
spriteset (name##_1_##cargo##_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+67, 0) }                                                 \
spriteset (name##_2_##cargo##_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+134, 0) }                                                \
spriteset (name##_3_##cargo##_sprites_right, IMAGEFILE)                              \
{ s##size##_r_template(x, y+201, 0) }                                                \
spritegroup name##_##cargo##_sprites_right1                                          \
{ loading: [name##_1_##cargo##_sprites_right];                                       \
  loaded: [name##_##cargo##_sprites_right0]; }                                       \
spritegroup name##_##cargo##_sprites_right2                                          \
{ loading: [name##_2_##cargo##_sprites_right];                                       \
  loaded: [name##_##cargo##_sprites_right0]; }                                       \
spritegroup name##_##cargo##_sprites_right3                                          \
{ loading: [name##_3_##cargo##_sprites_right];                                       \
  loaded: [name##_##cargo##_sprites_right0]; }                                       \

// шаблон цистерны
#define tanker_layout_template(name, size, x, y)                                     \
spriteset (name##_sprites_left, IMAGEFILE)                                           \
{ s##size##_template(x, y, 0) }                                                      \
spriteset (name##_sprites_right, IMAGEFILE)                                          \
{ s##size##_r_template(x, y, 0) }                                                    \
random_switch (FEAT_TRAINS, SELF, name##_sprites,                                    \
  bitmask(TRIGGER_VEHICLE_SERVICE))                                                  \
{ 1: name##_sprites_left;                                                            \
  1: name##_sprites_right; }                                                         \


