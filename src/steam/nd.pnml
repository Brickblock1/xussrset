 // nd

#define IMAGEFILE  "src/steam/nd.png"
purchase_sprites(nd_v1, 0, 0)
purchase_sprites(nd_v2, 100, 0)
steam_sprites(6, nd_engine, 32,  40)
tender_sprites(4, nd_v1_tender, 447,  40)
#undef IMAGEFILE
purchase_sprites_select(nd, 1897)

switch (FEAT_TRAINS, SELF, nd_tender_sprites_start,
  build_year >= 1897)
{
  1: nv_tender_sprites_start;
     nd_v1_tender_sprites_start;
}

steamer_direction_template(nd, _sprites_start)
short_vehicle(nd)

switch (FEAT_TRAINS, SELF, nd_engine_colour_mapping,
  cargo_subtype + (enable_cc_default * 1024 * (cargo_subtype == 0)))
{
  0: return ttdall_cc + 0x53;
  LV_RAL6002: return ttdall_cc + 0x53;
     return CB_FAILED;
}

switch (FEAT_TRAINS, SELF, nd_tender_colour_mapping,
[ set_offset_to(-2),
  prev_vehicle_cargo_subtype() + (enable_cc_default * 1024 * (prev_vehicle_cargo_subtype() == 0))])
{
  0: return ttdall_cc + 0x53;
  LV_RAL6002: return ttdall_cc + 0x53;
     return CB_FAILED;
}

switch (FEAT_TRAINS, SELF, nd_long_b1897_cargo_subtype_text,
  cargo_subtype)
{
  return string(STR_REFIT_FACTORY_GENERAL_TYPE, string(STR_PURCHASE_HINT_TYPE_53), string(STR_REFIT_TTD_53));
}

switch (FEAT_TRAINS, SELF, nd_long_a1897_cargo_subtype_text,
  cargo_subtype)
{
  return string(STR_REFIT_FACTORY_GENERAL_TYPE, string(STR_PURCHASE_HINT_TYPE_67), string(STR_REFIT_TTD_53));
}

  livery_template_build_year(nd_long, 1897)

  livery_template1(nd_short, TTD_53)
livery_template_longnames(nd)

steamer_direction_template(nd, _colour_mapping)

engine_steam_1_effect(nd, -3, 12)
engine_speed_change_after3(nd, 75,
                               90, 1903,
                               105, 1912,
                               120, 1936)
engine_penalise_speed0(nd)
engine_RC_change_build_after(nd, 123,
                                 129, 1897)
engine_cost_change_build_after(nd, 5,
                                   6, 1897)
engine_TE_change_build_after(nd, get_tec_int(65.0, 54+47),
                                 get_tec_int(70.0, 54+47), 1897)
engine_tender(nd)
engine_tender_length(nd, 5, 1, 3, 1)

hint_engine_with_subtype_5fact(nd_b1897, 
                               STR_PURCHASE_HINT_ENGINE_TYPE_PASSENGER_STEAM_WITH_SUBTYPE, STR_PURCHASE_HINT_TYPE_53, 
                               STR_PURCHASE_HINT_SECTIONS_1, 
                               1892, 1896, 
                               STR_PURCHASE_HINT_FACTORY_KOLOMNA,
                               STR_PURCHASE_HINT_FACTORY_LUGANSK,
                               STR_PURCHASE_HINT_FACTORY_BRYANSK,
                               STR_PURCHASE_HINT_FACTORY_PUTILOVSKY,
                               STR_PURCHASE_HINT_FACTORY_SORMOVO) 
hint_engine_with_subtype_5fact(nd_a1897, 
                               STR_PURCHASE_HINT_ENGINE_TYPE_PASSENGER_STEAM_WITH_SUBTYPE, STR_PURCHASE_HINT_TYPE_67, 
                               STR_PURCHASE_HINT_SECTIONS_1, 
                               1897, 1902, 
                               STR_PURCHASE_HINT_FACTORY_KOLOMNA,
                               STR_PURCHASE_HINT_FACTORY_LUGANSK,
                               STR_PURCHASE_HINT_FACTORY_BRYANSK,
                               STR_PURCHASE_HINT_FACTORY_PUTILOVSKY,
                               STR_PURCHASE_HINT_FACTORY_SORMOVO)
hint_change_after(nd, 1897)

item (FEAT_TRAINS, nd, 505) {
  property {
    name: string(STR_NAME_ND);
    vehicle_dates(1892, 1902, 40, 10, 5, 5)
    vehicle_pass()
    vehicle_steam(650, 54+47, 65.0)
  }
  graphics {
    default: nd_sprites;
    purchase: nd_purchase_sprites;
    articulated_part: nd_articulated_part;
    can_attach_wagon: any_can_attach_wagon;
    start_stop: any_start_stop;
    speed: nd_speed;
    purchase_speed: nd_purchase_speed;
    bitmask_vehicle_info: nd_bitmask_vehicle_info;
    cargo_capacity: return 0;
    create_effect: nd_create_effect;
    tractive_effort_coefficient: nd_tractive_effort_coefficient;
    running_cost_factor: nd_running_cost_factor;
    cargo_subtype_text: nd_cargo_subtype_text;
    colour_mapping: nd_colour_mapping;
    cost_factor: nd_cost_factor;
    length: nd_length;
    additional_text: nd_additional_text;
  }
}

long_name_template(nd, STR_LONGNAME_ND)
models_default_cargo_template(nd)
allow_steamer(nd)
